import json
import random
from pathlib import Path

import boto3

# s3://ra2ce-data/hackathon_uncertainty/flood_maps/
bucket = "ra2ce-data"
_root_dir = "hackathon_uncertainty/vulnerability_curves/"

client = boto3.client("s3")
result = client.list_objects(Bucket=bucket, Prefix=_root_dir, Delimiter="/")
_vulnerability_curves = [
    str(Path(_content["Key"]).relative_to(_root_dir))
    for _content in result.get("Contents")
]
_selected_vc = random.choice(_vulnerability_curves)

print(json.dumps(_selected_vc))
